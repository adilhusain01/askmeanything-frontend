import{f as I,r as u,j as i}from"./index-DIf-sEGv.js";import{a as m}from"./axios-BimPEqV4.js";import{P as E}from"./Paper-Dt7QoGLR.js";import{T as y}from"./Typography-CfKGFZgn.js";import"./DefaultPropsProvider-B2oaWIJB.js";async function j(n,p){const s="https://api.on-demand.io/chat/v1/sessions",r={apikey:n},c={pluginIds:[],externalUserId:p};try{return(await m.post(s,c,{headers:r})).data.data.id}catch(a){throw console.error("Error creating chat session:",a),a}}async function f(n,p,s){const r=`https://api.on-demand.io/chat/v1/sessions/${p}/query`,c={apikey:n},a={endpointId:"predefined-openai-gpt4o",query:s,pluginIds:[],responseMode:"sync"};try{return(await m.post(r,a,{headers:c})).data}catch(d){throw console.error("Error submitting query:",d),d}}const k=({onSubmit:n,placeholder:p})=>{const[s,r]=u.useState("");u.useState("");const c=u.useRef(null);u.useEffect(()=>{c.current.focus()},[]);const a=l=>{r(l.target.value)},d=l=>{if(l.key==="Enter"){if(l.preventDefault(),!s.trim())return;n(s.trim()),r("")}};return i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(y,{sx:{color:"#00e676",marginRight:"8px",fontSize:"1.25rem"},children:">"}),i.jsx("input",{ref:c,type:"text",value:s,onChange:a,onKeyPress:d,placeholder:p,style:{flex:1,backgroundColor:"#13131a",color:"#fff",border:"none",outline:"none",fontSize:"1.25rem"}})]})},N=()=>{const{id:n}=I(),[p,s]=u.useState([]),[r,c]=u.useState(null),[a,d]=u.useState(""),l="6yFYPvTI8vXITsmZxPgZMLGyBjmiqYpS",x=async t=>{try{return(await m.get(`http://localhost:5000/api/usermeta/${t}`)).data}catch(e){throw console.error("Error fetching user metadata:",e),e}},w=t=>{const{user:e,questinoaire:o}=t,h="Mimick a person who has these attributes and preferences as you can get what his taste is from the questions and the answers he gave. Now answer anything asked about you (you are this person now) and sound and reply like him with a cheesy rizz and a lot of a flirt.",$=`
      User Info:
      - Age: ${e.age}
      - Gender: ${e.gender}
      - Occupation: ${e.occupation}
      - City: ${e.city}, ${e.state}, ${e.country}
      - Hobbies: ${e.hobbies.join(", ")}
      - Smoking: ${e.smoking?"Yes":"No"}
      - Drinking: ${e.drinking?"Yes":"No"}
      - Body Type: ${e.body_type}
      - Height: ${e.height} ft
      - Weight: ${e.weight} kg
    `,b=o.questions.map(g=>`${g.question} - ${g.answer}`).join(`
`);return`${h}

${$}

Questionnaire:
${b}`};u.useEffect(()=>{(async()=>{try{console.log("Fetching user metadata...");const e=await x(n),o=w(e);console.log("User metadata fetched and processed:",o),console.log(e.user),d(e.user.username),console.log("Creating chat session...");const h=await j(l,n);console.log("Chat session created with ID:",h),console.log("Submitting initial metadata..."),await f(l,h,o),console.log("Initial metadata submitted"),c(h)}catch(e){console.error("Error initializing chat session:",e)}})()},[n]);const S=async t=>{if(t.toLowerCase()==="clear"){s([]);return}s(e=>[...e,{type:"question",text:t}]),console.log("Question submitted:",t);try{if(!r){console.error("Session ID is not available"),s(o=>[...o,{type:"error",text:"Session ID is not available"}]);return}console.log("Submitting query...");const e=await f(l,r,t);console.log("Query response received:",e),s(o=>[...o,{type:"answer",text:e.data.answer}])}catch(e){console.error("Error fetching answer:",e),s(o=>[...o,{type:"error",text:"Error fetching answer"}])}};return i.jsxs("main",{className:"grid grid-cols-12 h-screen w-full",children:[i.jsx("section",{className:"col-span-3 p-[2rem]"}),i.jsxs(E,{className:"col-span-6",sx:{p:4,backgroundColor:"#13131a",color:"#fff",height:"100vh",overflowY:"auto",display:"flex",flexDirection:"column",fontSize:"1.25rem"},children:[p.map((t,e)=>i.jsx(y,{sx:{color:t.type==="question"?"#FEFAE0":t.type==="answer"||t.type==="response"?"#DDA15E":"#ff1744",fontSize:"1.25rem",lineHeight:"1.5",letterSpacing:"1.75px"},children:t.type==="question"?`> ${t.text}`:`${t.text}`},e)),i.jsx(k,{onSubmit:S,placeholder:`Ask ${a} anything you want...`,sx:{color:"#FEFAE0"}})]}),i.jsx("section",{className:"col-span-3 p-[2rem]"})]})};export{N as default};
