import{r as n,a as E,u as N,j as e,b as k}from"./index-6krkwngn.js";import{z as l,T as x}from"./index-uqckcfsl.js";import{T as w,i as C}from"./axios-CHCPJmvu.js";import{Q as q,B as j}from"./ReactToastify-E6-3pMxY.js";import{B,a as P}from"./Button-DGgeBxKc.js";import"./ButtonBase-D1-w5-5M.js";import"./Paper-Da0X2NpR.js";const R=()=>{const[t,b]=n.useState(""),[o,v]=n.useState(""),[a,m]=n.useState({email:"",password:""}),c=E(),{login:y}=N(),S=l.object({email:l.string().email({message:"Invalid email address"}),password:l.string().min(6,{message:"Password must be at least 6 characters long"})}),T=async r=>{var u,p,h,g,f;r.preventDefault();const d=S.safeParse({email:t,password:o});if(d.success){m({email:"",password:""});try{const i=(await C.post("https://hammerhead-app-qqm5y.ondigitalocean.app/api/auth",{email:t,password:o})).data.accessToken;localStorage.setItem("token",i),y(i);const L=k(i);j.success("Login successful! Let's fill the Questionaire"),L.doneQuestinoaire?c("/"):setTimeout(()=>{c("/info")},3500)}catch(s){j.error(((g=(h=s.response)==null?void 0:h.data)==null?void 0:g.message)||"Login error"),console.error("Login error",(f=s.response)==null?void 0:f.data),console.error("Login error",s)}}else{const s=d.error.format();m({email:((u=s.email)==null?void 0:u._errors[0])||"",password:((p=s.password)==null?void 0:p._errors[0])||""})}};return e.jsxs("main",{className:"flex items-center justify-center w-full h-screen",children:[e.jsx("div",{className:"px-[2.5rem] py-[2.5rem] bg-white rounded-xl min-w-[30rem]",children:e.jsxs(B,{component:"form",onSubmit:T,noValidate:!0,className:"flex flex-col items-center justify-center gap-[1.25rem]",children:[e.jsx(w,{component:"h1",variant:"h5",className:"text-center font-bold",children:"Login"}),e.jsx(x,{required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:t,onChange:r=>b(r.target.value),error:!!a.email,helperText:a.email}),e.jsx(x,{required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:o,onChange:r=>v(r.target.value),error:!!a.password,helperText:a.password}),e.jsx(P,{type:"submit",fullWidth:!0,variant:"contained",sx:{color:"white",backgroundColor:"black",fontSize:"1rem",borderRadius:"0.75rem",padding:"0.5rem 2rem"},children:"Sign In"}),e.jsx("div",{children:e.jsxs(w,{variant:"body2",children:["Do not have an account?",e.jsx("a",{href:"/register",className:"text-blue-500",children:"Sign Up"})]})})]})}),e.jsx(q,{})]})};export{R as default};
